## –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞

### –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö, –±–∏–±–ª–∏–æ—Ç–µ–∫


```python
!pip install catboost
```

    Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/
    Collecting catboost
      Downloading catboost-1.0.6-cp37-none-manylinux1_x86_64.whl (76.6 MB)
    [K     |‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 76.6 MB 127 kB/s 
    [?25hRequirement already satisfied: graphviz in /usr/local/lib/python3.7/dist-packages (from catboost) (0.10.1)
    Requirement already satisfied: matplotlib in /usr/local/lib/python3.7/dist-packages (from catboost) (3.2.2)
    Requirement already satisfied: scipy in /usr/local/lib/python3.7/dist-packages (from catboost) (1.7.3)
    Requirement already satisfied: six in /usr/local/lib/python3.7/dist-packages (from catboost) (1.15.0)
    Requirement already satisfied: plotly in /usr/local/lib/python3.7/dist-packages (from catboost) (5.5.0)
    Requirement already satisfied: pandas>=0.24.0 in /usr/local/lib/python3.7/dist-packages (from catboost) (1.3.5)
    Requirement already satisfied: numpy>=1.16.0 in /usr/local/lib/python3.7/dist-packages (from catboost) (1.21.6)
    Requirement already satisfied: python-dateutil>=2.7.3 in /usr/local/lib/python3.7/dist-packages (from pandas>=0.24.0->catboost) (2.8.2)
    Requirement already satisfied: pytz>=2017.3 in /usr/local/lib/python3.7/dist-packages (from pandas>=0.24.0->catboost) (2022.2.1)
    Requirement already satisfied: kiwisolver>=1.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib->catboost) (1.4.4)
    Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,>=2.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib->catboost) (3.0.9)
    Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.7/dist-packages (from matplotlib->catboost) (0.11.0)
    Requirement already satisfied: typing-extensions in /usr/local/lib/python3.7/dist-packages (from kiwisolver>=1.0.1->matplotlib->catboost) (4.1.1)
    Requirement already satisfied: tenacity>=6.2.0 in /usr/local/lib/python3.7/dist-packages (from plotly->catboost) (8.0.1)
    Installing collected packages: catboost
    Successfully installed catboost-1.0.6
    


```python
import pandas as pd
import numpy as np

import re
import nltk
nltk.download('omw-1.4')
nltk.download('wordnet')
nltk.download('punkt')
from nltk.stem import WordNetLemmatizer 
nltk.download("stopwords")
from nltk.corpus import stopwords as nltk_stopwords
from sklearn.feature_extraction.text import TfidfVectorizer
from tqdm import tqdm
tqdm.pandas()

from sklearn.model_selection import train_test_split, cross_val_score, GridSearchCV
from sklearn.utils import shuffle
from sklearn.metrics import f1_score, accuracy_score

from sklearn.linear_model import LogisticRegression
from catboost import CatBoostClassifier
from sklearn.ensemble import RandomForestClassifier
from lightgbm import LGBMClassifier
```

    [nltk_data] Downloading package omw-1.4 to /root/nltk_data...
    [nltk_data]   Package omw-1.4 is already up-to-date!
    [nltk_data] Downloading package wordnet to /root/nltk_data...
    [nltk_data]   Package wordnet is already up-to-date!
    [nltk_data] Downloading package punkt to /root/nltk_data...
    [nltk_data]   Package punkt is already up-to-date!
    [nltk_data] Downloading package stopwords to /root/nltk_data...
    [nltk_data]   Package stopwords is already up-to-date!
    


```python
# –ø—Ä–æ—Å–º–æ—Ç—Ä, –≥–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∫–∞—Ç–∞–ª–æ–≥ —Å —Ñ–∞–π–ª–∞–º–∏ –Ω–∞ COLAB
#from google.colab import drive
#drive.mount('/content/drive')
```

    Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount("/content/drive", force_remount=True).
    


```python
# –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–∞—Ç–∞–ª–æ–≥—É –∏ —É—Ç–æ—á–Ω–µ–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è –ø–∞–ø–æ–∫
#import os
#os.listdir('/content/drive/My Drive/Colab Notebooks/–Ø–Ω–¥–µ–∫—Å/–ü—Ä–æ–µ–∫—Ç 11 ¬´–í–∏–∫–∏—à–æ–ø¬ª/–î–ê–ù–ù–´–ï')
```




    ['toxic_comments.csv', 'cased_L-12_H-768_A-12', 'rndlr96_EnBERT']




```python
# –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
#data = pd.read_csv('/content/drive/My Drive/Colab Notebooks/–Ø–Ω–¥–µ–∫—Å/–ü—Ä–æ–µ–∫—Ç 11 ¬´–í–∏–∫–∏—à–æ–ø¬ª/–î–ê–ù–ù–´–ï/toxic_comments.csv')
```


```python
data = pd.read_csv('/datasets/toxic_comments.csv')
```


```python
data
```





  <div id="df-7c572796-0941-41b7-85cf-740305a33c3a">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>toxic</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Explanation\nWhy the edits made under my usern...</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>D'aww! He matches this background colour I'm s...</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Hey man, I'm really not trying to edit war. It...</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>"\nMore\nI can't make any real suggestions on ...</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>You, sir, are my hero. Any chance you remember...</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>159566</th>
      <td>":::::And for the second time of asking, when ...</td>
      <td>0</td>
    </tr>
    <tr>
      <th>159567</th>
      <td>You should be ashamed of yourself \n\nThat is ...</td>
      <td>0</td>
    </tr>
    <tr>
      <th>159568</th>
      <td>Spitzer \n\nUmm, theres no actual article for ...</td>
      <td>0</td>
    </tr>
    <tr>
      <th>159569</th>
      <td>And it looks like it was actually you who put ...</td>
      <td>0</td>
    </tr>
    <tr>
      <th>159570</th>
      <td>"\nAnd ... I really don't think you understand...</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>159571 rows √ó 2 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-7c572796-0941-41b7-85cf-740305a33c3a')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-7c572796-0941-41b7-85cf-740305a33c3a button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-7c572796-0941-41b7-85cf-740305a33c3a');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>





```python
data.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 159571 entries, 0 to 159570
    Data columns (total 2 columns):
     #   Column  Non-Null Count   Dtype 
    ---  ------  --------------   ----- 
     0   text    159571 non-null  object
     1   toxic   159571 non-null  int64 
    dtypes: int64(1), object(1)
    memory usage: 2.4+ MB
    


```python
data.duplicated().sum() # –ø–æ–¥—Å—á—ë—Ç —è–≤–Ω—ã—Ö –¥—É–±–ª–∏–∫–∞—Ç–æ–≤
```




    0



### –í—ã–≤–æ–¥

**–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ:**

1.	DataFrame —Å–æ–¥–µ—Ä–∂–∏—Ç 159571 —Å—Ç—Ä–æ–∫ –∏ 2 —Å—Ç–æ–ª–±—Ü–∞
2.	–í —Å—Ç–æ–ª–±—Ü–µ ¬´text¬ª –¥–∞–Ω–Ω—ã–µ —Ç–∏–ø–∞ object, –ø—Ä–æ–ø—É—Å–∫–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç
3.	–í —Å—Ç–æ–ª–±—Ü–µ ¬´toxic¬ª –¥–∞–Ω–Ω—ã–µ —Ç–∏–ø–∞ int64, –ø—Ä–æ–ø—É—Å–∫–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç
4.	–Ø–≤–Ω—ã–µ –¥—É–±–ª–∏–∫–∞—Ç—ã –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç


### –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö


```python
corpus = data['text']
```


```python
corpus
```




    0         Explanation\nWhy the edits made under my usern...
    1         D'aww! He matches this background colour I'm s...
    2         Hey man, I'm really not trying to edit war. It...
    3         "\nMore\nI can't make any real suggestions on ...
    4         You, sir, are my hero. Any chance you remember...
                                    ...                        
    159566    ":::::And for the second time of asking, when ...
    159567    You should be ashamed of yourself \n\nThat is ...
    159568    Spitzer \n\nUmm, theres no actual article for ...
    159569    And it looks like it was actually you who put ...
    159570    "\nAnd ... I really don't think you understand...
    Name: text, Length: 159571, dtype: object




```python
# —Ñ—É–Ω–∫—Ü–∏—è –ª–µ–º–º–∞—Ç–∏–∑–∞—Ü–∏–∏
def lemmatize(text):
    lemmatizer = WordNetLemmatizer()
    lemm_list = nltk.word_tokenize(text)
    lemm_text = " ".join([lemmatizer.lemmatize(l) for l in lemm_list])     
    return lemm_text

# —Ñ—É–Ω–∫—Ü–∏—è –æ—á–∏—Å—Ç–∫–∏
def clear_text(text):
    text = re.sub(r'[^a-zA-Z]', ' ', text)
    return " ".join(text.split())
```


```python
data['lemm_text'] = data['text'].progress_apply(clear_text)
data['lemm_text'] = data['lemm_text'].progress_apply(lemmatize)
```

    100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 159571/159571 [00:05<00:00, 30446.15it/s]
    100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 159571/159571 [02:05<00:00, 1270.48it/s]
    


```python
data
```





  <div id="df-584dc506-6957-4faf-8f6e-231800541851">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>text</th>
      <th>toxic</th>
      <th>lemm_text</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Explanation\nWhy the edits made under my usern...</td>
      <td>0</td>
      <td>Explanation Why the edits made under my userna...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>D'aww! He matches this background colour I'm s...</td>
      <td>0</td>
      <td>D aww He match this background colour I m seem...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Hey man, I'm really not trying to edit war. It...</td>
      <td>0</td>
      <td>Hey man I m really not trying to edit war It s...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>"\nMore\nI can't make any real suggestions on ...</td>
      <td>0</td>
      <td>More I can t make any real suggestion on impro...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>You, sir, are my hero. Any chance you remember...</td>
      <td>0</td>
      <td>You sir are my hero Any chance you remember wh...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>159566</th>
      <td>":::::And for the second time of asking, when ...</td>
      <td>0</td>
      <td>And for the second time of asking when your vi...</td>
    </tr>
    <tr>
      <th>159567</th>
      <td>You should be ashamed of yourself \n\nThat is ...</td>
      <td>0</td>
      <td>You should be ashamed of yourself That is a ho...</td>
    </tr>
    <tr>
      <th>159568</th>
      <td>Spitzer \n\nUmm, theres no actual article for ...</td>
      <td>0</td>
      <td>Spitzer Umm there no actual article for prosti...</td>
    </tr>
    <tr>
      <th>159569</th>
      <td>And it looks like it was actually you who put ...</td>
      <td>0</td>
      <td>And it look like it wa actually you who put on...</td>
    </tr>
    <tr>
      <th>159570</th>
      <td>"\nAnd ... I really don't think you understand...</td>
      <td>0</td>
      <td>And I really don t think you understand I came...</td>
    </tr>
  </tbody>
</table>
<p>159571 rows √ó 3 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-584dc506-6957-4faf-8f6e-231800541851')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-584dc506-6957-4faf-8f6e-231800541851 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-584dc506-6957-4faf-8f6e-231800541851');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>





```python
data_lemm = data
```


```python
features_start = data_lemm['lemm_text']
target_start = data_lemm['toxic']
```


```python
# –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –∫–ª–∞—Å—Å–æ–≤
features_zeros = features_start[target_start == 0] 
features_ones = features_start[target_start == 1] 

target_zeros  = target_start[target_start == 0] 
target_ones = target_start[target_start == 1] 

print(features_zeros.shape)
print(features_ones.shape)
print(target_zeros.shape)
print(target_ones.shape)
```

    (143346,)
    (16225,)
    (143346,)
    (16225,)
    


```python
print('–ë–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤ = ', round(target_ones.shape[0] / target_zeros.shape[0] * 10), ':',
      round((round(100 - target_ones.shape[0] / target_zeros.shape[0] * 100) / 10)))
```

    –ë–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤ =  1 : 9
    


```python
features_train_start, features_test_start, target_train, target_test = train_test_split(features_start, target_start, test_size=0.25)
```


```python
nltk.download('stopwords')
stopwords = set(nltk_stopwords.words('english'))
count_tf_idf = TfidfVectorizer(stop_words=stopwords)

features_train = count_tf_idf.fit_transform(features_train_start)
features_test = count_tf_idf.transform(features_test_start)
```

    [nltk_data] Downloading package stopwords to /root/nltk_data...
    [nltk_data]   Package stopwords is already up-to-date!
    

### –í—ã–≤–æ–¥

**–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö:**

1.	–í—ã–ø–æ–ª–Ω–µ–Ω–∞ –ª–µ–º–º–∞—Ç–∏–∑–∞—Ü–∏—è –∏ –æ—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
2.	–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω –±–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤ (1:9)
3.	–í—ã–ø–æ–ª–Ω–µ–Ω–æ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –≤–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Ü–µ–ª–µ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
4.	–í—ã–±–æ—Ä–∫–∞ —Ä–∞–∑–¥–µ–ª–µ–Ω–∞ –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—É—é –∏ —Ç–µ—Å—Ç–æ–≤—É—é (75:25)


## –û–±—É—á–µ–Ω–∏–µ

###  LogisticRegression


```python
model = LogisticRegression()
parametrs = { 'C': range(1, 20, 2),
               'class_weight':['balanced', None] }
search = GridSearchCV(model, parametrs, cv=3, scoring='f1')
search.fit(features_train, target_train)
best_model_LogisticRegression = search.best_estimator_
print('# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #')
print('–ú–æ–¥–µ–ª—å:', best_model_LogisticRegression)
print('–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏:', search.best_params_)
print('F1:', round(search.best_score_, 3))
```

    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    

    # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #
    –ú–æ–¥–µ–ª—å: LogisticRegression(C=11, class_weight='balanced')
    –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏: {'C': 11, 'class_weight': 'balanced'}
    F1: 0.762
    

    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    

### CatBoostClassifier


```python
model = CatBoostClassifier()
parametrs = { 'depth': range (1, 2, 1),
              'n_estimators': range (1, 2, 1) }
search = GridSearchCV(model, parametrs, cv=3, scoring='f1')
search.fit(features_train, target_train)
best_model_CatBoostClassifier = search.best_estimator_
print('# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #')
print('–ú–æ–¥–µ–ª—å:', best_model_CatBoostClassifier)
print('–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏:', search.best_params_)
print('best_score:', round(search.best_score_, 3))
```

    Learning rate set to 0.5
    0:	learn: 0.3709003	total: 286ms	remaining: 0us
    Learning rate set to 0.5
    0:	learn: 0.3714175	total: 286ms	remaining: 0us
    Learning rate set to 0.5
    0:	learn: 0.3681059	total: 289ms	remaining: 0us
    Learning rate set to 0.5
    0:	learn: 0.3702821	total: 434ms	remaining: 0us
    # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #
    –ú–æ–¥–µ–ª—å: <catboost.core.CatBoostClassifier object at 0x7faabe99f090>
    –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏: {'depth': 1, 'n_estimators': 1}
    best_score: 0.264
    

### RandomForestClassifier


```python
model = RandomForestClassifier()
parametrs = { 'max_depth': range (1, 4),
              'n_estimators': range (1, 4) }
search = GridSearchCV(model, parametrs, cv=3, scoring='f1')
search.fit(features_train, target_train)
best_model_RandomForestClassifier = search.best_estimator_
print('# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #')
print('–ú–æ–¥–µ–ª—å:', best_model_RandomForestClassifier)
print('–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏:', search.best_params_)
print('best_score:', round(search.best_score_, 3))
```

    # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #
    –ú–æ–¥–µ–ª—å: RandomForestClassifier(max_depth=2, n_estimators=2)
    –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏: {'max_depth': 2, 'n_estimators': 2}
    best_score: 0.059
    

### LGBMClassifier


```python
model = LGBMClassifier()
parametrs = { 'max_depth': range (1, 4),
              'n_estimators': range (1, 4) }
search = GridSearchCV(model, parametrs, cv=3, scoring='f1')
search.fit(features_train, target_train)
best_model_LGBMClassifier = search.best_estimator_
print('# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #')
print('–ú–æ–¥–µ–ª—å:', best_model_LGBMClassifier)
print('–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏:', search.best_params_)
print('best_score:', round(search.best_score_, 3))
```

    # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #
    –ú–æ–¥–µ–ª—å: LGBMClassifier(max_depth=3, n_estimators=3)
    –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏: {'max_depth': 3, 'n_estimators': 3}
    best_score: 0.001
    

### –í—ã–≤–æ–¥

**–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –æ–±—É—á–µ–Ω–∏—è –∏ –ø–æ–¥–±–æ—Ä–∞ –ª—É—á—à–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –º–æ–¥–µ–ª–µ–π, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ:**

1.  –ú–æ–¥–µ–ª—å: LogisticRegression(C=11, class_weight='balanced')
    * –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏: {'C': 11, 'class_weight': 'balanced'}
    * F1: 0.762
2.  –ú–æ–¥–µ–ª—å: <catboost.core.CatBoostClassifier object at 0x7faabe99f090>
    * –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏: {'depth': 1, 'n_estimators': 1}
    * F1: 0.264
3.  –ú–æ–¥–µ–ª—å: RandomForestClassifier(max_depth=2, n_estimators=2)
    * –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏: {'max_depth': 2, 'n_estimators': 2}
    * F1: 0.059
4.  –ú–æ–¥–µ–ª—å: LGBMClassifier(max_depth=3, n_estimators=3)
    * –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏: {'max_depth': 3, 'n_estimators': 3}
    * F1: 0.001

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ


```python
list_model = [best_model_LogisticRegression,
              best_model_CatBoostClassifier,
              best_model_RandomForestClassifier,
              best_model_LGBMClassifier]
```


```python
list_model
```




    [LogisticRegression(C=11, class_weight='balanced'),
     <catboost.core.CatBoostClassifier at 0x7faabe99f090>,
     RandomForestClassifier(max_depth=2, n_estimators=2),
     LGBMClassifier(max_depth=3, n_estimators=3)]




```python
best_model = None
best_result = 0
for mod in list_model:
  mod.fit(features_train, target_train)
  test_predictions = mod.predict(features_test)
  result = f1_score(target_test, test_predictions)
  if best_result < result:
    best_result = result
    best_model = mod
print('# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #')
print("–õ—É—á—à–∞—è –º–æ–¥–µ–ª—å:", best_model)
print("F1 –Ω–∞–∏–ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ:", round(best_result, 3))
```

    /usr/local/lib/python3.7/dist-packages/sklearn/linear_model/_logistic.py:818: ConvergenceWarning: lbfgs failed to converge (status=1):
    STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.
    
    Increase the number of iterations (max_iter) or scale the data as shown in:
        https://scikit-learn.org/stable/modules/preprocessing.html
    Please also refer to the documentation for alternative solver options:
        https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
      extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG,
    

    Learning rate set to 0.5
    0:	learn: 0.3702821	total: 454ms	remaining: 0us
    # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #
    –õ—É—á—à–∞—è –º–æ–¥–µ–ª—å: LogisticRegression(C=11, class_weight='balanced')
    F1 –Ω–∞–∏–ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ: 0.761
    

### –í—ã–≤–æ–¥

**–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ:**

1.  –õ—É—á—à–∞—è –º–æ–¥–µ–ª—å: LogisticRegression(C=11, class_weight='balanced')
2.  F1 –Ω–∞–∏–ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ: 0.761
3.  –ó–Ω–∞—á–µ–Ω–∏–µ F1 —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è–µ—Ç —É—Å–ª–æ–≤–∏—é: F1 –Ω–µ –º–µ–Ω—å—à–µ 0.75.
4.  –ü–æ–ø—ã—Ç–∞–µ–º—Å—è —É–ª—É—á—à–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –¥—Ä—É–≥–∏—Ö (–∫—Ä–æ–º–µ LogisticRegression()) –º–æ–¥–µ–ª–µ–π –∑–∞ —Å—á—ë—Ç –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ –∫–ª–∞—Å—Å–æ–≤.

### –ë–æ—Ä—å–±–∞ —Å –¥–∏—Å–±–∞–ª–∞–Ω—Å–æ–º

*–¢–∞–∫ –∫–∞–∫ –±–∞–ª–∞–Ω—Å –ø—Ä–∏–º–µ—Ä–Ω–æ 1 –∫ 9 –ø–æ–ø—ã—Ç–∞–µ–º—Å—è —Å–Ω–∞—á–∞–ª–∞ —É–º–µ–Ω—å—à–∏—Ç—å –±–æ–ª—å—à–∏–π –∫–ª–∞—Å—Å –∏ –ø–æ—Å–º–æ—Ç—Ä–µ—å –Ω–∞ –∑–Ω–∞—á–µ–Ω–∏–µ F1, –∞ –∑–∞—Ç–µ–º —É–≤–µ–ª–∏—á–∏—Ç—å –º–µ–Ω—å—à–∏–π –∫–ª–∞—Å—Å.*


```python
exp_list_model = [best_model_CatBoostClassifier,
              best_model_RandomForestClassifier,
              best_model_LGBMClassifier]
```


```python
# —Ñ—É–Ω–∫—Ü–∏—è —É–º–µ–Ω—å—à–µ–Ω–∏—è –≤—ã–±–æ—Ä–∫–∏
def downsample(features_train_s, target_t, fraction):

  target_zeros = target_t[target_t == 0]
  target_ones = target_t[target_t == 1]

  target_zeros_downsample = target_zeros.sample(round(target_zeros.shape[0] * fraction), random_state=12345)
  target_downsample = pd.concat([target_zeros_downsample, target_ones])
  features_downsample = features_train_s.iloc[target_downsample.index]
  features_downsample, target_downsample = shuffle(features_downsample, target_downsample, random_state=12345)
  
  return features_downsample, target_downsample
```


```python
  features_train_start_exp = features_train_start.reset_index(drop=True)
  target_train_exp = target_train.reset_index(drop=True)
```


```python
target_train_exp.shape
```




    (119678,)




```python
features_train_start_exp.shape
```




    (119678,)




```python
# –ø–æ–∏—Å–∫ –Ω–∞–∏–±–æ–ª–µ–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –ú–ù–û–ñ–ò–¢–ï–õ–Ø (—ÖN), —É–º–µ–Ω—å—à–∞—é—â–µ–≥–æ –≤—ã–±–æ—Ä–∫—É, –∞ —Ç–∞–∫–∂–µ –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –∏ –µ—ë F1
for j in  np.arange(0.1, 0.9, 0.1):
  features_downsampled, target_downsampled = downsample(features_train_start_exp, target_train_exp, j)

  features_downsampled = count_tf_idf.fit_transform(features_downsampled)
  features_test = count_tf_idf.transform(features_test_start)

  best_model = None
  best_result = 0
  best_—ÖN = 0.1
  for mod in exp_list_model:
    mod.fit(features_downsampled, target_downsampled)
    test_predictions = mod.predict(features_test)
    result = f1_score(target_test, test_predictions)
    if best_result < result:
      best_result = result
      best_model = mod
      best_—ÖN = j
print('# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #')
print("–õ—É—á—à–∞—è –º–æ–¥–µ–ª—å:", best_model)
print("F1 –Ω–∞–∏–ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ:", round(best_result, 3))
print("–õ—É—á—à–∏–π –ú–ù–û–ñ–ò–¢–ï–õ–¨ (—ÖN), —É–º–µ–Ω—å—à–∞—é—â–∏–π –≤—ã–±–æ—Ä–∫—É:", best_—ÖN)
```

    Learning rate set to 0.5
    0:	learn: 0.6408057	total: 68.2ms	remaining: 0us
    Learning rate set to 0.5
    0:	learn: 0.6133017	total: 103ms	remaining: 0us
    Learning rate set to 0.5
    0:	learn: 0.5653127	total: 143ms	remaining: 0us
    Learning rate set to 0.5
    0:	learn: 0.5221810	total: 179ms	remaining: 0us
    Learning rate set to 0.5
    0:	learn: 0.4878598	total: 219ms	remaining: 0us
    Learning rate set to 0.5
    0:	learn: 0.4551786	total: 257ms	remaining: 0us
    Learning rate set to 0.5
    0:	learn: 0.4291228	total: 297ms	remaining: 0us
    Learning rate set to 0.5
    0:	learn: 0.4081993	total: 337ms	remaining: 0us
    # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #
    –õ—É—á—à–∞—è –º–æ–¥–µ–ª—å: <catboost.core.CatBoostClassifier object at 0x7faabe99f090>
    F1 –Ω–∞–∏–ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ: 0.256
    –õ—É—á—à–∏–π –ú–ù–û–ñ–ò–¢–ï–õ–¨ (—ÖN), —É–º–µ–Ω—å—à–∞—é—â–∏–π –≤—ã–±–æ—Ä–∫—É: 0.8
    


```python
# —Ñ—É–Ω–∫—Ü–∏—è —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –≤—ã–±–æ—Ä–∫–∏
def upsample(features_train_s, target_t, repeat):
    features_zeros = features_train_s[target_t == 0]
    features_ones = features_train_s[target_t == 1]
    target_zeros = target_t[target_t == 0]
    target_ones = target_t[target_t == 1]

    features_upsampled = pd.concat([features_zeros] + [features_ones] * repeat)
    target_upsampled = pd.concat([target_zeros] + [target_ones] * repeat)
    
    features_upsampled, target_upsampled = shuffle(
        features_upsampled, target_upsampled, random_state=12345)
    
    return features_upsampled, target_upsampled
```


```python
# –ø–æ–∏—Å–∫ –Ω–∞–∏–±–æ–ª–µ–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –ú–ù–û–ñ–ò–¢–ï–õ–Ø (—ÖN), —É–≤–µ–ª–∏—á–∏–≤–∞—é—â–µ–≥–æ –≤—ã–±–æ—Ä–∫—É, –∞ —Ç–∞–∫–∂–µ –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –∏ –µ—ë F1
for j in  np.arange(1, 7, 2):
  features_upsampled, target_upsampled = upsample(features_train_start_exp, target_train_exp, j)

  features_upsampled = count_tf_idf.fit_transform(features_upsampled)
  features_test = count_tf_idf.transform(features_test_start)

  best_model = None
  best_result = 0
  best_—ÖN = 1
  for mod in exp_list_model:
    mod.fit(features_upsampled, target_upsampled)
    test_predictions = mod.predict(features_test)
    result = f1_score(target_test, test_predictions)
    if best_result < result:
      best_result = result
      best_model = mod
      best_—ÖN = j
print('# # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #')
print("–õ—É—á—à–∞—è –º–æ–¥–µ–ª—å:", best_model)
print("F1 –Ω–∞–∏–ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ:", round(best_result, 3))
print("–õ—É—á—à–∏–π –ú–ù–û–ñ–ò–¢–ï–õ–¨ (—ÖN), —É–≤–µ–ª–∏—á–∏–≤–∞—é—â–∏–π –≤—ã–±–æ—Ä–∫—É:", best_—ÖN)
```

    Learning rate set to 0.5
    0:	learn: 0.3702820	total: 447ms	remaining: 0us
    Learning rate set to 0.5
    0:	learn: 0.5506162	total: 497ms	remaining: 0us
    Learning rate set to 0.5
    0:	learn: 0.6136533	total: 574ms	remaining: 0us
    # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # # #
    –õ—É—á—à–∞—è –º–æ–¥–µ–ª—å: LGBMClassifier(max_depth=3, n_estimators=3)
    F1 –Ω–∞–∏–ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ: 0.373
    –õ—É—á—à–∏–π –ú–ù–û–ñ–ò–¢–ï–õ–¨ (—ÖN), —É–≤–µ–ª–∏—á–∏–≤–∞—é—â–∏–π –≤—ã–±–æ—Ä–∫—É: 5
    

### –í—ã–≤–æ–¥

**–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –±–æ—Ä—å–±—ã —Å –¥–∏—Å–±–∞–ª–∞–Ω—Å–æ–º –∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –ø–æ–¥–±–æ—Ä–∞ –ª—É—á—à–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –º–æ–¥–µ–ª–µ–π (–∫—Ä–æ–º–µ LogisticRegression()), —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ:**

1.  –õ—É—á—à–∞—è –º–æ–¥–µ–ª—å: LGBMClassifier(max_depth=3, n_estimators=3)
2.  F1 –Ω–∞–∏–ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ: 0.373
3.  –õ—É—á—à–∏–π –ú–ù–û–ñ–ò–¢–ï–õ–¨ (—ÖN), —É–≤–µ–ª–∏—á–∏–≤–∞—é—â–∏–π –≤—ã–±–æ—Ä–∫—É: 5
4.  –ü—Ä–∏—Ä–æ—Å—Ç F1 –ø–æ—Ä—è–¥–∫–∞ 11%, –æ–¥–Ω–∞–∫–æ –Ω–µ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è–µ—Ç —É—Å–ª–æ–≤–∏—é: F1 –Ω–µ –º–µ–Ω—å—à–µ 0.75.


## –û–±—â–∏–π –≤—ã–≤–æ–¥—ã

**–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ:**

1.  DataFrame —Å–æ–¥–µ—Ä–∂–∏—Ç 159571 —Å—Ç—Ä–æ–∫ –∏ 2 —Å—Ç–æ–ª–±—Ü–∞
2.  –í —Å—Ç–æ–ª–±—Ü–µ ¬´text¬ª –¥–∞–Ω–Ω—ã–µ —Ç–∏–ø–∞ object, –ø—Ä–æ–ø—É—Å–∫–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç
3.  –í —Å—Ç–æ–ª–±—Ü–µ ¬´toxic¬ª –¥–∞–Ω–Ω—ã–µ —Ç–∏–ø–∞ int64, –ø—Ä–æ–ø—É—Å–∫–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç
4.  –Ø–≤–Ω—ã–µ –¥—É–±–ª–∏–∫–∞—Ç—ã –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç.

**–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö:**

1.  –í—ã–ø–æ–ª–Ω–µ–Ω–∞ –ª–µ–º–º–∞—Ç–∏–∑–∞—Ü–∏—è –∏ –æ—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
2.  –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω –±–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤ (1:9)
3.  –í—ã–ø–æ–ª–Ω–µ–Ω–æ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –≤–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —Ü–µ–ª–µ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
4.  –í—ã–±–æ—Ä–∫–∞ —Ä–∞–∑–¥–µ–ª–µ–Ω–∞ –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—É—é –∏ —Ç–µ—Å—Ç–æ–≤—É—é (75:25)

**–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –æ–±—É—á–µ–Ω–∏—è –∏ –ø–æ–¥–±–æ—Ä–∞ –ª—É—á—à–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –º–æ–¥–µ–ª–µ–π, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ:**

1.  –ú–æ–¥–µ–ª—å: LogisticRegression(C=11, class_weight='balanced')
    * –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏: {'C': 11, 'class_weight': 'balanced'}
    * F1: 0.762
2.  –ú–æ–¥–µ–ª—å: <catboost.core.CatBoostClassifier object at 0x7faabe99f090>
    * –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏: {'depth': 1, 'n_estimators': 1}
    * F1: 0.264
3.  –ú–æ–¥–µ–ª—å: RandomForestClassifier(max_depth=2, n_estimators=2)
    * –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏: {'max_depth': 2, 'n_estimators': 2}
    * F1: 0.059
4.  –ú–æ–¥–µ–ª—å: LGBMClassifier(max_depth=3, n_estimators=3)
    * –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏: {'max_depth': 3, 'n_estimators': 3}
    * F1: 0.001

**–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ:**

1.  –õ—É—á—à–∞—è –º–æ–¥–µ–ª—å: LogisticRegression(C=11, class_weight='balanced')
2.  F1 –Ω–∞–∏–ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ: 0.761
3.  –ó–Ω–∞—á–µ–Ω–∏–µ F1 —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è–µ—Ç —É—Å–ª–æ–≤–∏—é: F1 –Ω–µ –º–µ–Ω—å—à–µ 0.75.
4.  –ü–æ–ø—ã—Ç–∞–µ–º—Å—è —É–ª—É—á—à–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –¥—Ä—É–≥–∏—Ö (–∫—Ä–æ–º–µ LogisticRegression()) –º–æ–¥–µ–ª–µ–π –∑–∞ —Å—á—ë—Ç –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ –∫–ª–∞—Å—Å–æ–≤.

**–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –±–æ—Ä—å–±—ã —Å –¥–∏—Å–±–∞–ª–∞–Ω—Å–æ–º –∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –ø–æ–¥–±–æ—Ä–∞ –ª—É—á—à–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –º–æ–¥–µ–ª–µ–π (–∫—Ä–æ–º–µ LogisticRegression()), —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ:**

1.  –õ—É—á—à–∞—è –º–æ–¥–µ–ª—å: LGBMClassifier(max_depth=3, n_estimators=3)
2.  F1 –Ω–∞–∏–ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ: 0.373
3.  –õ—É—á—à–∏–π –ú–ù–û–ñ–ò–¢–ï–õ–¨ (—ÖN), —É–≤–µ–ª–∏—á–∏–≤–∞—é—â–∏–π –≤—ã–±–æ—Ä–∫—É: 5
4.  –ü—Ä–∏—Ä–æ—Å—Ç F1 –ø–æ—Ä—è–¥–∫–∞ 11%, –æ–¥–Ω–∞–∫–æ –Ω–µ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è–µ—Ç —É—Å–ª–æ–≤–∏—é: F1 –Ω–µ –º–µ–Ω—å—à–µ 0.75.

**–†–ï–ó–Æ–ú–ï:**

1.  –õ—É—á—à–∞—è –º–æ–¥–µ–ª—å: LogisticRegression(C=11, class_weight='balanced')
2.  F1 –º–æ–¥–µ–ª–∏ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ: 0.761
