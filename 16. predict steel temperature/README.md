# Оптимизация производственных расходов металлургического комбината

## Описание проекта

Чтобы оптимизировать производственные расходы, металлургический комбинат ООО «Так закаляем сталь» решил уменьшить потребление электроэнергии на этапе обработки стали. Вам предстоит построить модель, которая предскажет температуру стали. Требование бизнеса: MAE ≤ 6.8.

## Ключевые слова проекта

`регрессия` `мультиколлинеарность` `важность факторов` `подбор гиперпараметров` `выбор модели МО`

## Навыки и инструменты

`исследовательский анализ данных` `Python` `Pandas` `NumPy` `Scikit-learn` `Matplotlib` `Seaborn` `Catboost` `Xgboost`

## Результаты исследования

**I. В результате предварительного анализа данных, установлено:**

1. В столбце "Время замера" таблицы `data_temp` (результаты измерения температуры) тип object, а должен быть datetime.
2. В столбце "Начало нагрева дугой" таблицы `data_arc` (данные об электродах) тип object, а должен быть datetime.
3. В столбце "Конец нагрева дугой" таблицы `data_arc` (данные об электродах) тип object, а должен быть datetime.
4. Во всех столбцах таблиц `data_wire_time` (данные о проволочных материалах (время)), `data_bulk_time` (данные о подаче сыпучих материалов (время)) тип object, а должен быть datetime.

**II. В результате анализа описательной статистики и пропусков, установлено:**

1. В таблице `data_wire` (данные о проволочных материалах (объём)) многие столбцы имеют пропуски от 0.84% до 99.97%.
2. В таблице `data_temp` (результаты измерения температуры) в столбце "Температура" имеется 18.24% пропусков.
3. В таблице `data_bulk` (данные о подаче сыпучих материалов (объём)) многие столбцы имеют пропуски от 10.32% до 99.97%.
4. В таблице `data_arc` (данные об электродах) в столбце "Реактивная мощность" обнаружено аномальное минимальное значение: - 715.504924.

**III. На основе предварительного анализа данных, для дальнейшего исследования установлены следующие положения:**

1. Поскольку случайные величины всегда порождаются бесконечным количеством причин и чаще всего ни одна из них не имеет дисперсии, сравнимой с дисперсией самой случайной величины, то большинство встречающихся **в практике** случайных величин подчинено **нормальному закону распределения**. [Нормальное распределение — **наиболее распространенное в природе распределение** непрерывных величин. Математическим обоснованием этого факта служит центральная предельная теорема](http://datascientist.one/central-limit-theorem/).

2. **Выбросом** считается наблюдение, которое лежит аномально далеко от остальных из серии параллельных наблюдений. Т.е. выбросы – это значения количественного признака, располагающиеся на краях интервала допустимых значений. Таким образом, при определении выбросов будем опираться на значения 0-перцентиля и 100-перцентиля, а также рекомендации бизнеса и особенности технологического процесса. **Удалению будут подлежать супервыбросы (относительно далеко отстающие единичные значения или небольшие группы  относительно основного распределения).**

**IV. Таким образом, для дальнейшего моделирования необходимо вынести следующие тезисы:**

1. так как при моделировании будет решаться задача регрессе, то для нее лучше вообще убрать столбцы с временем, так как модель может начать пытаться найти функциональную связь в датах и времени;
2. исходя из технологического процесса пропуски в таблицах `data_wire` и `data_bulk` обусловлены тем, что на каких-то итерациях процесса просто не добавляли либо проволочных материалов, либо сыпучих материалов, поэтому целесообразно их заполнить нулями;
3. в таблице `data_temp` в столбце "Температура" находится целевой признак и, поэтому мы будем вынуждены удалить строки с пропусками, так же стоит поступить с  супервыбросами, обнаруженными:
    - в таблице `data_arc` столбец «Реактивная мощность» при этом для моделирования возьмём диапазон значений [0, 3.5];
    - в таблице `data_temp` столбец «Температура», при этом для моделирования возьмём диапазон значений [1400, 1705] (целевой признак);
    - в таблице `data_wire` столбец «Wire 1», при этом для моделирования возьмём диапазон значений [0, 260];
    - в таблице `data_wire` столбец «Wire 2», при этом для моделирования возьмём диапазон значений [0, 260];
    - в таблице `data_bulk` столбец «Bulk 12», при этом для моделирования возьмём диапазон значений [0, 1000];
    - в таблице `data_bulk` столбец «Bulk 15», при этом для моделирования возьмём диапазон значений [0, 400].

**V. В результате подготовки данных:**

1. Устранена мультиколлинеарность.
2. Перед моделированием применено масштабирование.

**VI. В результате обучения и подбора лучших параметров моделей, установлено:**

1. Лучшая модель: XGBRegressor.
2. Параметры лучшей модели: {'colsample_bytree': 0.7, 'learning_rate': 0.05, 'max_depth': 5, 'min_child_weight': 4, 'n_estimators': 200, 'nthread': 4, 'objective': 'reg:linear', 'silent': 1, 'subsample': 0.7}.
3. Качество модели (MAE): 6.904.

**VII. В результате проверки качества модели на тестовой выборке:**

1.  MAE лучшей модели на тестовой выборке: 6.7.
2.  Значение MAE удовлетворяет условию бизнеса: MAE ≤ 6.8.
3.  В тройку самых значимых факторов входит:
  * начальная температура;
  * объем проволочных материалов;
  * объем сыпучих материалов.
 
 ## Статус проекта
 `Завершен`
