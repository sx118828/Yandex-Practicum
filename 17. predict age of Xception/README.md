# Определение (Xception) возраста покупателей 

## Описание проекта

Сетевой супермаркет «Х» внедряет систему компьютерного зрения для обработки фотографий покупателей. Фотофиксация в прикассовой зоне поможет определять возраст клиентов, чтобы:

* анализировать покупки и предлагать товары, которые могут заинтересовать покупателей этой возрастной группы;
* контролировать добросовестность кассиров при продаже алкоголя.

Необходимо построить модель, которая по фотографии определит приблизительный возраст человека. В распоряжении имеется набор фотографий людей с указанием возраста.

## Ключевые слова проекта

`компьютерное зрение` `Xception` `классификация` `подбор гиперпараметров` `выбор модели МО`

## Навыки и инструменты

`исследовательский анализ данных` `Python` `Pandas` `NumPy` `Matplotlib` `Seaborn` `Tensorflow` `Keras`

## Результаты исследования

**I. В результате исследовательского анализа, установлено:**

* общее число фотографий в датасете 7591;
* target_size=(224, 224);
* batch_size=32;
* распределение возрастов по типу Пуассона;
* среднее (31) значение смещено вправо относительно медианного (29);
* максимальный возраст - 100, минимальный - 1.

**II. В результате обучения:**

1. Размер входного изображения: (224, 224, 3).
2. Применена аугментация: "горизонтальное отражение", "сдвиг по ширине и высоте".
3. Обучение проходило в 10 этапах по 2 эпохи в каждом (за исключением 4-го этапа), при этом до 9-го этапа Learning_rate был равен 0.001, затем 0.0001.
4. Время обучения составило порядка 80 минут на бесплатном GPU от Goole Colab.
5. Лучшее качество модели на валидационной выборке - val_loss: 5.2075 - val_mape: 24.6453.
6. Модель почти готова, так как дает порядка 75% точности, [при максимальных 79% на датасете ImageNet](https://habr.com/ru/post/347564/).

**РЕЗЮМЕ:**

1. В качестве базовой модели взята - Xception.
2. Веса взяты с предобученной Xception на ImageNet.
3. В архитектуре Xception отсутствует два последних слоя и она "заморожена" с предобученными весами.
4. Добавлены два слоя: GlobalAveragePooling2D и Dense (функция активации: 'relu').
5. Функция потерь: MAE, метрика качества: MAPE.
6. Выбран итерационный метод, для оптимизации целевой функции - 'adam' до 9-го этапа с шагом: 0.001, после 9-го этапа - 0.0001.
 
 ## Статус проекта
 `Завершен`

