## Загрузка и подготовка данных


```python
# импорт библиотек
import pandas as pd
import numpy as np
import warnings
warnings.simplefilter("ignore")
import math
from statistics import mean

from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error
from sklearn.metrics import r2_score
from sklearn.metrics import mean_absolute_error


import seaborn as sns
import matplotlib.pyplot as plt
%matplotlib inline
```


```python
# посмотр, где находится каталог с файлами на COLAB
from google.colab import drive
drive.mount('/content/drive')
```

    Mounted at /content/drive
    


```python
# получение доступа к каталогу и уточнение названия папок
import os
os.listdir('/content/drive/My Drive/Colab Notebooks/Яндекс/Проект 7 Выбор локации для скважины')
```




    ['geo_data_0.csv', 'geo_data_2.csv', 'geo_data_1.csv', 'ПРАВКА', 'GitHub']




```python
# загрузка данных
data_0 = pd.read_csv('/content/drive/My Drive/Colab Notebooks/Яндекс/Проект 7 Выбор локации для скважины/geo_data_0.csv')
data_1 = pd.read_csv('/content/drive/My Drive/Colab Notebooks/Яндекс/Проект 7 Выбор локации для скважины/geo_data_1.csv')
data_2 = pd.read_csv('/content/drive/My Drive/Colab Notebooks/Яндекс/Проект 7 Выбор локации для скважины/geo_data_2.csv')
```


```python
# просмотр типов данных и кол-ва ненулевых значений
data_0.info()
print('______________________________________')
data_1.info()
print('______________________________________')
data_2.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 100000 entries, 0 to 99999
    Data columns (total 5 columns):
     #   Column   Non-Null Count   Dtype  
    ---  ------   --------------   -----  
     0   id       100000 non-null  object 
     1   f0       100000 non-null  float64
     2   f1       100000 non-null  float64
     3   f2       100000 non-null  float64
     4   product  100000 non-null  float64
    dtypes: float64(4), object(1)
    memory usage: 3.8+ MB
    ______________________________________
    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 100000 entries, 0 to 99999
    Data columns (total 5 columns):
     #   Column   Non-Null Count   Dtype  
    ---  ------   --------------   -----  
     0   id       100000 non-null  object 
     1   f0       100000 non-null  float64
     2   f1       100000 non-null  float64
     3   f2       100000 non-null  float64
     4   product  100000 non-null  float64
    dtypes: float64(4), object(1)
    memory usage: 3.8+ MB
    ______________________________________
    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 100000 entries, 0 to 99999
    Data columns (total 5 columns):
     #   Column   Non-Null Count   Dtype  
    ---  ------   --------------   -----  
     0   id       100000 non-null  object 
     1   f0       100000 non-null  float64
     2   f1       100000 non-null  float64
     3   f2       100000 non-null  float64
     4   product  100000 non-null  float64
    dtypes: float64(4), object(1)
    memory usage: 3.8+ MB
    


```python
# подсчет нулевых значений
data_0.isna().sum()
```




    id         0
    f0         0
    f1         0
    f2         0
    product    0
    dtype: int64




```python
data_1.isna().sum()
```




    id         0
    f0         0
    f1         0
    f2         0
    product    0
    dtype: int64




```python
data_2.isna().sum()
```




    id         0
    f0         0
    f1         0
    f2         0
    product    0
    dtype: int64




```python
# конкатенация таблиц
data_all = pd.concat([data_0] + [data_1] + [data_2], axis=1)
```


```python
data_all
```





  <div id="df-fc6ff3bd-84b5-49d5-a7d8-6b828c041d33">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>f0</th>
      <th>f1</th>
      <th>f2</th>
      <th>product</th>
      <th>id</th>
      <th>f0</th>
      <th>f1</th>
      <th>f2</th>
      <th>product</th>
      <th>id</th>
      <th>f0</th>
      <th>f1</th>
      <th>f2</th>
      <th>product</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>txEyH</td>
      <td>0.705745</td>
      <td>-0.497823</td>
      <td>1.221170</td>
      <td>105.280062</td>
      <td>kBEdx</td>
      <td>-15.001348</td>
      <td>-8.276000</td>
      <td>-0.005876</td>
      <td>3.179103</td>
      <td>fwXo0</td>
      <td>-1.146987</td>
      <td>0.963328</td>
      <td>-0.828965</td>
      <td>27.758673</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2acmU</td>
      <td>1.334711</td>
      <td>-0.340164</td>
      <td>4.365080</td>
      <td>73.037750</td>
      <td>62mP7</td>
      <td>14.272088</td>
      <td>-3.475083</td>
      <td>0.999183</td>
      <td>26.953261</td>
      <td>WJtFt</td>
      <td>0.262778</td>
      <td>0.269839</td>
      <td>-2.530187</td>
      <td>56.069697</td>
    </tr>
    <tr>
      <th>2</th>
      <td>409Wp</td>
      <td>1.022732</td>
      <td>0.151990</td>
      <td>1.419926</td>
      <td>85.265647</td>
      <td>vyE1P</td>
      <td>6.263187</td>
      <td>-5.948386</td>
      <td>5.001160</td>
      <td>134.766305</td>
      <td>ovLUW</td>
      <td>0.194587</td>
      <td>0.289035</td>
      <td>-5.586433</td>
      <td>62.871910</td>
    </tr>
    <tr>
      <th>3</th>
      <td>iJLyR</td>
      <td>-0.032172</td>
      <td>0.139033</td>
      <td>2.978566</td>
      <td>168.620776</td>
      <td>KcrkZ</td>
      <td>-13.081196</td>
      <td>-11.506057</td>
      <td>4.999415</td>
      <td>137.945408</td>
      <td>q6cA6</td>
      <td>2.236060</td>
      <td>-0.553760</td>
      <td>0.930038</td>
      <td>114.572842</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Xdl7t</td>
      <td>1.988431</td>
      <td>0.155413</td>
      <td>4.751769</td>
      <td>154.036647</td>
      <td>AHL4O</td>
      <td>12.702195</td>
      <td>-8.147433</td>
      <td>5.004363</td>
      <td>134.766305</td>
      <td>WPMUX</td>
      <td>-0.515993</td>
      <td>1.716266</td>
      <td>5.899011</td>
      <td>149.600746</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>99995</th>
      <td>DLsed</td>
      <td>0.971957</td>
      <td>0.370953</td>
      <td>6.075346</td>
      <td>110.744026</td>
      <td>QywKC</td>
      <td>9.535637</td>
      <td>-6.878139</td>
      <td>1.998296</td>
      <td>53.906522</td>
      <td>4GxBu</td>
      <td>-1.777037</td>
      <td>1.125220</td>
      <td>6.263374</td>
      <td>172.327046</td>
    </tr>
    <tr>
      <th>99996</th>
      <td>QKivN</td>
      <td>1.392429</td>
      <td>-0.382606</td>
      <td>1.273912</td>
      <td>122.346843</td>
      <td>ptvty</td>
      <td>-10.160631</td>
      <td>-12.558096</td>
      <td>5.005581</td>
      <td>137.945408</td>
      <td>YKFjq</td>
      <td>-1.261523</td>
      <td>-0.894828</td>
      <td>2.524545</td>
      <td>138.748846</td>
    </tr>
    <tr>
      <th>99997</th>
      <td>3rnvd</td>
      <td>1.029585</td>
      <td>0.018787</td>
      <td>-1.348308</td>
      <td>64.375443</td>
      <td>09gWa</td>
      <td>-7.378891</td>
      <td>-3.084104</td>
      <td>4.998651</td>
      <td>137.945408</td>
      <td>tKPY3</td>
      <td>-1.199934</td>
      <td>-2.957637</td>
      <td>5.219411</td>
      <td>157.080080</td>
    </tr>
    <tr>
      <th>99998</th>
      <td>7kl59</td>
      <td>0.998163</td>
      <td>-0.528582</td>
      <td>1.583869</td>
      <td>74.040764</td>
      <td>rqwUm</td>
      <td>0.665714</td>
      <td>-6.152593</td>
      <td>1.000146</td>
      <td>30.132364</td>
      <td>nmxp2</td>
      <td>-2.419896</td>
      <td>2.417221</td>
      <td>-5.548444</td>
      <td>51.795253</td>
    </tr>
    <tr>
      <th>99999</th>
      <td>1CWhH</td>
      <td>1.764754</td>
      <td>-0.266417</td>
      <td>5.722849</td>
      <td>149.633246</td>
      <td>relB0</td>
      <td>-3.426139</td>
      <td>-7.794274</td>
      <td>-0.003299</td>
      <td>3.179103</td>
      <td>V9kWn</td>
      <td>-2.551421</td>
      <td>-2.025625</td>
      <td>6.090891</td>
      <td>102.775767</td>
    </tr>
  </tbody>
</table>
<p>100000 rows × 15 columns</p>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-fc6ff3bd-84b5-49d5-a7d8-6b828c041d33')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-fc6ff3bd-84b5-49d5-a7d8-6b828c041d33 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-fc6ff3bd-84b5-49d5-a7d8-6b828c041d33');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>





```python
# подсчет доли дубликатов
print(data_0.duplicated().sum() / len(data_0) * 100)
print(data_1.duplicated().sum() / len(data_1) * 100)
print(data_2.duplicated().sum() / len(data_2) * 100)
```

    0.0
    0.0
    0.0
    


```python
# вывод количества уникальных значений 'id'
len(data_0['id'].unique())

```




    99990




```python
# вывод количества уникальных значений 'id'
len(data_1['id'].unique())
```




    99996




```python
# вывод количества уникальных значений 'id'
len(data_2['id'].unique())
```




    99996




```python
# сортировка по количеству повторений уникальных значений 'id'
data_0['id'].value_counts(ascending=False).head(12)
```




    fiKDv    2
    QcMuo    2
    AGS9W    2
    Tdehs    2
    74z30    2
    A5aEY    2
    bsk9y    2
    TtcGQ    2
    HZww2    2
    bxg6G    2
    iAaqy    1
    PQ2MT    1
    Name: id, dtype: int64




```python
data_0_dupl = data_0.query('id == ["fiKDv", "QcMuo", "AGS9W", "Tdehs", "74z30", "A5aEY", "bsk9y", "TtcGQ", "HZww2", "bxg6G"]')
```


```python
data_0_dupl
```





  <div id="df-54e8db77-07ea-44e6-8e39-d517b398770b">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>f0</th>
      <th>f1</th>
      <th>f2</th>
      <th>product</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>931</th>
      <td>HZww2</td>
      <td>0.755284</td>
      <td>0.368511</td>
      <td>1.863211</td>
      <td>30.681774</td>
    </tr>
    <tr>
      <th>1364</th>
      <td>bxg6G</td>
      <td>0.411645</td>
      <td>0.856830</td>
      <td>-3.653440</td>
      <td>73.604260</td>
    </tr>
    <tr>
      <th>1949</th>
      <td>QcMuo</td>
      <td>0.506563</td>
      <td>-0.323775</td>
      <td>-2.215583</td>
      <td>75.496502</td>
    </tr>
    <tr>
      <th>3389</th>
      <td>A5aEY</td>
      <td>-0.039949</td>
      <td>0.156872</td>
      <td>0.209861</td>
      <td>89.249364</td>
    </tr>
    <tr>
      <th>7530</th>
      <td>HZww2</td>
      <td>1.061194</td>
      <td>-0.373969</td>
      <td>10.430210</td>
      <td>158.828695</td>
    </tr>
    <tr>
      <th>16633</th>
      <td>fiKDv</td>
      <td>0.157341</td>
      <td>1.028359</td>
      <td>5.585586</td>
      <td>95.817889</td>
    </tr>
    <tr>
      <th>21426</th>
      <td>Tdehs</td>
      <td>0.829407</td>
      <td>0.298807</td>
      <td>-0.049563</td>
      <td>96.035308</td>
    </tr>
    <tr>
      <th>41724</th>
      <td>bxg6G</td>
      <td>-0.823752</td>
      <td>0.546319</td>
      <td>3.630479</td>
      <td>93.007798</td>
    </tr>
    <tr>
      <th>42529</th>
      <td>AGS9W</td>
      <td>1.454747</td>
      <td>-0.479651</td>
      <td>0.683380</td>
      <td>126.370504</td>
    </tr>
    <tr>
      <th>51970</th>
      <td>A5aEY</td>
      <td>-0.180335</td>
      <td>0.935548</td>
      <td>-2.094773</td>
      <td>33.020205</td>
    </tr>
    <tr>
      <th>60140</th>
      <td>TtcGQ</td>
      <td>0.569276</td>
      <td>-0.104876</td>
      <td>6.440215</td>
      <td>85.350186</td>
    </tr>
    <tr>
      <th>63593</th>
      <td>QcMuo</td>
      <td>0.635635</td>
      <td>-0.473422</td>
      <td>0.862670</td>
      <td>64.578675</td>
    </tr>
    <tr>
      <th>64022</th>
      <td>74z30</td>
      <td>0.741456</td>
      <td>0.459229</td>
      <td>5.153109</td>
      <td>140.771492</td>
    </tr>
    <tr>
      <th>66136</th>
      <td>74z30</td>
      <td>1.084962</td>
      <td>-0.312358</td>
      <td>6.990771</td>
      <td>127.643327</td>
    </tr>
    <tr>
      <th>69163</th>
      <td>AGS9W</td>
      <td>-0.933795</td>
      <td>0.116194</td>
      <td>-3.655896</td>
      <td>19.230453</td>
    </tr>
    <tr>
      <th>75715</th>
      <td>Tdehs</td>
      <td>0.112079</td>
      <td>0.430296</td>
      <td>3.218993</td>
      <td>60.964018</td>
    </tr>
    <tr>
      <th>89582</th>
      <td>bsk9y</td>
      <td>0.398908</td>
      <td>-0.400253</td>
      <td>10.122376</td>
      <td>163.433078</td>
    </tr>
    <tr>
      <th>90815</th>
      <td>fiKDv</td>
      <td>0.049883</td>
      <td>0.841313</td>
      <td>6.394613</td>
      <td>137.346586</td>
    </tr>
    <tr>
      <th>92341</th>
      <td>TtcGQ</td>
      <td>0.110711</td>
      <td>1.022689</td>
      <td>0.911381</td>
      <td>101.318008</td>
    </tr>
    <tr>
      <th>97785</th>
      <td>bsk9y</td>
      <td>0.378429</td>
      <td>0.005837</td>
      <td>0.160827</td>
      <td>160.637302</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-54e8db77-07ea-44e6-8e39-d517b398770b')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-54e8db77-07ea-44e6-8e39-d517b398770b button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-54e8db77-07ea-44e6-8e39-d517b398770b');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>





```python
# сортировка по количеству повторений уникальных значений 'id'
data_1['id'].value_counts(ascending=False).head(6)
```




    wt4Uk    2
    LHZR0    2
    5ltQ6    2
    bfPNe    2
    kBEdx    1
    lAVJZ    1
    Name: id, dtype: int64




```python
data_1_dupl = data_1.query('id == ["wt4Uk", "LHZR0", "5ltQ6", "bfPNe"]')
```


```python
data_1_dupl
```





  <div id="df-c893d79b-8846-4e11-bfc4-e5c3bb129ef4">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>f0</th>
      <th>f1</th>
      <th>f2</th>
      <th>product</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1305</th>
      <td>LHZR0</td>
      <td>11.170835</td>
      <td>-1.945066</td>
      <td>3.002872</td>
      <td>80.859783</td>
    </tr>
    <tr>
      <th>2721</th>
      <td>bfPNe</td>
      <td>-9.494442</td>
      <td>-5.463692</td>
      <td>4.006042</td>
      <td>110.992147</td>
    </tr>
    <tr>
      <th>5849</th>
      <td>5ltQ6</td>
      <td>-3.435401</td>
      <td>-12.296043</td>
      <td>1.999796</td>
      <td>57.085625</td>
    </tr>
    <tr>
      <th>41906</th>
      <td>LHZR0</td>
      <td>-8.989672</td>
      <td>-4.286607</td>
      <td>2.009139</td>
      <td>57.085625</td>
    </tr>
    <tr>
      <th>47591</th>
      <td>wt4Uk</td>
      <td>-9.091098</td>
      <td>-8.109279</td>
      <td>-0.002314</td>
      <td>3.179103</td>
    </tr>
    <tr>
      <th>82178</th>
      <td>bfPNe</td>
      <td>-6.202799</td>
      <td>-4.820045</td>
      <td>2.995107</td>
      <td>84.038886</td>
    </tr>
    <tr>
      <th>82873</th>
      <td>wt4Uk</td>
      <td>10.259972</td>
      <td>-9.376355</td>
      <td>4.994297</td>
      <td>134.766305</td>
    </tr>
    <tr>
      <th>84461</th>
      <td>5ltQ6</td>
      <td>18.213839</td>
      <td>2.191999</td>
      <td>3.993869</td>
      <td>107.813044</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-c893d79b-8846-4e11-bfc4-e5c3bb129ef4')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-c893d79b-8846-4e11-bfc4-e5c3bb129ef4 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-c893d79b-8846-4e11-bfc4-e5c3bb129ef4');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>





```python
# сортировка по количеству повторений уникальных значений 'id'
data_2['id'].value_counts(ascending=False).head(6)
```




    VF7Jo    2
    KUPhW    2
    xCHr8    2
    Vcm5J    2
    fwXo0    1
    B9hou    1
    Name: id, dtype: int64




```python
data_2_dupl = data_2.query('id == ["VF7Jo", "KUPhW", "xCHr8", "Vcm5J"]')
```


```python
data_2_dupl
```





  <div id="df-dbd0e524-166b-4af4-8be0-60ddcf364357">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>f0</th>
      <th>f1</th>
      <th>f2</th>
      <th>product</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>11449</th>
      <td>VF7Jo</td>
      <td>2.122656</td>
      <td>-0.858275</td>
      <td>5.746001</td>
      <td>181.716817</td>
    </tr>
    <tr>
      <th>28039</th>
      <td>xCHr8</td>
      <td>1.633027</td>
      <td>0.368135</td>
      <td>-2.378367</td>
      <td>6.120525</td>
    </tr>
    <tr>
      <th>43233</th>
      <td>xCHr8</td>
      <td>-0.847066</td>
      <td>2.101796</td>
      <td>5.597130</td>
      <td>184.388641</td>
    </tr>
    <tr>
      <th>44378</th>
      <td>Vcm5J</td>
      <td>-1.229484</td>
      <td>-2.439204</td>
      <td>1.222909</td>
      <td>137.968290</td>
    </tr>
    <tr>
      <th>45404</th>
      <td>KUPhW</td>
      <td>0.231846</td>
      <td>-1.698941</td>
      <td>4.990775</td>
      <td>11.716299</td>
    </tr>
    <tr>
      <th>49564</th>
      <td>VF7Jo</td>
      <td>-0.883115</td>
      <td>0.560537</td>
      <td>0.723601</td>
      <td>136.233420</td>
    </tr>
    <tr>
      <th>55967</th>
      <td>KUPhW</td>
      <td>1.211150</td>
      <td>3.176408</td>
      <td>5.543540</td>
      <td>132.831802</td>
    </tr>
    <tr>
      <th>95090</th>
      <td>Vcm5J</td>
      <td>2.587702</td>
      <td>1.986875</td>
      <td>2.482245</td>
      <td>92.327572</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-dbd0e524-166b-4af4-8be0-60ddcf364357')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-dbd0e524-166b-4af4-8be0-60ddcf364357 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-dbd0e524-166b-4af4-8be0-60ddcf364357');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>




**В результате поиска неявных дубликатов, установлено:**

1. В регионе "data_0" - 10 пар с одинаковыми "id".
2. В регионах "data_1", "data_2" по 4 пары с одинаковыми "id".
3. Так как, прослеживается парность и параметры меняются либо в сторону уменьшения, либо в сторону увеличения, можно предположить, что это результат доразветки скважин. По итогам доразведки уточнялись параметры скважины и ее объём запасов. Исходя из этого, удалим первые (неуточненные данные), а последние записи (по индексу) в соответствующих "id" оставим для дальнейших расчетов.


```python
data_0 = data_0.query("index not in [931, 1364, 1949, 3389, 16633, 21426, 42529, 60140, 64022, 89582]")
data_1 = data_1.query("index not in [1305, 2721, 5849, 47591]")
data_2 = data_2.query("index not in [11449, 28039, 44378, 45404]")
```


```python
# проверка результатов удаления дубликатов доразведанных скважин
data_0.info()
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 99990 entries, 0 to 99999
    Data columns (total 5 columns):
     #   Column   Non-Null Count  Dtype  
    ---  ------   --------------  -----  
     0   id       99990 non-null  object 
     1   f0       99990 non-null  float64
     2   f1       99990 non-null  float64
     3   f2       99990 non-null  float64
     4   product  99990 non-null  float64
    dtypes: float64(4), object(1)
    memory usage: 4.6+ MB
    


```python
# проверка результатов удаления дубликатов доразведанных скважин
data_1.info()
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 99996 entries, 0 to 99999
    Data columns (total 5 columns):
     #   Column   Non-Null Count  Dtype  
    ---  ------   --------------  -----  
     0   id       99996 non-null  object 
     1   f0       99996 non-null  float64
     2   f1       99996 non-null  float64
     3   f2       99996 non-null  float64
     4   product  99996 non-null  float64
    dtypes: float64(4), object(1)
    memory usage: 4.6+ MB
    


```python
# проверка результатов удаления дубликатов доразведанных скважин
data_2.info()
```

    <class 'pandas.core.frame.DataFrame'>
    Int64Index: 99996 entries, 0 to 99999
    Data columns (total 5 columns):
     #   Column   Non-Null Count  Dtype  
    ---  ------   --------------  -----  
     0   id       99996 non-null  object 
     1   f0       99996 non-null  float64
     2   f1       99996 non-null  float64
     3   f2       99996 non-null  float64
     4   product  99996 non-null  float64
    dtypes: float64(4), object(1)
    memory usage: 4.6+ MB
    


```python
# сброс индексов
data_0 = data_0.reset_index(drop = True)
data_1 = data_1.reset_index(drop = True)
data_2 = data_2.reset_index(drop = True)
```


```python
# просмотр описательной статистики
data_0.describe()
```





  <div id="df-3a77c01d-9241-439a-a73d-9acec91960ac">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>f0</th>
      <th>f1</th>
      <th>f2</th>
      <th>product</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>99990.000000</td>
      <td>99990.000000</td>
      <td>99990.000000</td>
      <td>99990.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.500412</td>
      <td>0.250149</td>
      <td>2.502656</td>
      <td>92.499482</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.871867</td>
      <td>0.504434</td>
      <td>3.248155</td>
      <td>44.289431</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-1.408605</td>
      <td>-0.848218</td>
      <td>-12.088328</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-0.072683</td>
      <td>-0.200877</td>
      <td>0.287887</td>
      <td>56.496838</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.502340</td>
      <td>0.250252</td>
      <td>2.516005</td>
      <td>91.849972</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1.073626</td>
      <td>0.700654</td>
      <td>4.714970</td>
      <td>128.564269</td>
    </tr>
    <tr>
      <th>max</th>
      <td>2.362331</td>
      <td>1.343769</td>
      <td>16.003790</td>
      <td>185.364347</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-3a77c01d-9241-439a-a73d-9acec91960ac')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-3a77c01d-9241-439a-a73d-9acec91960ac button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-3a77c01d-9241-439a-a73d-9acec91960ac');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>





```python
# просмотр описательной статистики
data_1.describe()
```





  <div id="df-84994806-3d9b-4a5d-828e-285ab4bddc34">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>f0</th>
      <th>f1</th>
      <th>f2</th>
      <th>product</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>99996.000000</td>
      <td>99996.000000</td>
      <td>99996.000000</td>
      <td>99996.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1.141450</td>
      <td>-4.796493</td>
      <td>2.494551</td>
      <td>68.825232</td>
    </tr>
    <tr>
      <th>std</th>
      <td>8.965922</td>
      <td>5.119900</td>
      <td>1.703579</td>
      <td>45.944649</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-31.609576</td>
      <td>-26.358598</td>
      <td>-0.018144</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-6.298525</td>
      <td>-8.267985</td>
      <td>1.000021</td>
      <td>26.953261</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1.153190</td>
      <td>-4.813005</td>
      <td>2.011479</td>
      <td>57.085625</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>8.621015</td>
      <td>-1.332704</td>
      <td>3.999904</td>
      <td>107.813044</td>
    </tr>
    <tr>
      <th>max</th>
      <td>29.421755</td>
      <td>18.734063</td>
      <td>5.019721</td>
      <td>137.945408</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-84994806-3d9b-4a5d-828e-285ab4bddc34')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-84994806-3d9b-4a5d-828e-285ab4bddc34 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-84994806-3d9b-4a5d-828e-285ab4bddc34');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>





```python
# просмотр описательной статистики
data_2.describe()
```





  <div id="df-5514f1c2-1f7e-4a13-a070-5cdc3bcf5215">
    <div class="colab-df-container">
      <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>f0</th>
      <th>f1</th>
      <th>f2</th>
      <th>product</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>99996.000000</td>
      <td>99996.000000</td>
      <td>99996.000000</td>
      <td>99996.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.001995</td>
      <td>-0.002034</td>
      <td>2.495132</td>
      <td>95.000425</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.732054</td>
      <td>1.730424</td>
      <td>3.473453</td>
      <td>44.748112</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-8.760004</td>
      <td>-7.084020</td>
      <td>-11.970335</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-1.162288</td>
      <td>-1.174805</td>
      <td>0.130359</td>
      <td>59.452094</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.009411</td>
      <td>-0.009433</td>
      <td>2.484236</td>
      <td>94.925613</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1.158477</td>
      <td>1.163760</td>
      <td>4.858720</td>
      <td>130.590822</td>
    </tr>
    <tr>
      <th>max</th>
      <td>7.238262</td>
      <td>7.844801</td>
      <td>16.739402</td>
      <td>190.029838</td>
    </tr>
  </tbody>
</table>
</div>
      <button class="colab-df-convert" onclick="convertToInteractive('df-5514f1c2-1f7e-4a13-a070-5cdc3bcf5215')"
              title="Convert this dataframe to an interactive table."
              style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M0 0h24v24H0V0z" fill="none"/>
    <path d="M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z"/><path d="M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z"/>
  </svg>
      </button>

  <style>
    .colab-df-container {
      display:flex;
      flex-wrap:wrap;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

      <script>
        const buttonEl =
          document.querySelector('#df-5514f1c2-1f7e-4a13-a070-5cdc3bcf5215 button.colab-df-convert');
        buttonEl.style.display =
          google.colab.kernel.accessAllowed ? 'block' : 'none';

        async function convertToInteractive(key) {
          const element = document.querySelector('#df-5514f1c2-1f7e-4a13-a070-5cdc3bcf5215');
          const dataTable =
            await google.colab.kernel.invokeFunction('convertToInteractive',
                                                     [key], {});
          if (!dataTable) return;

          const docLinkHtml = 'Like what you see? Visit the ' +
            '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
            + ' to learn more about interactive tables.';
          element.innerHTML = '';
          dataTable['output_type'] = 'display_data';
          await google.colab.output.renderOutput(dataTable, element);
          const docLink = document.createElement('div');
          docLink.innerHTML = docLinkHtml;
          element.appendChild(docLink);
        }
      </script>
    </div>
  </div>




## Вывод

**В результате подготовки данных, установлено:**

1. Пропуски отсутствуют.
2. Тип данных во всех столбцах float64, кроме столбца "id" - object.
3. В регионе "data_0" - 10 пар с одинаковыми "id".
4. В регионах "data_1", "data_2" по 4 пары с одинаковыми "id".
5. Так как, прослеживается парность и параметры меняются либо в сторону уменьшения, либо в сторону увеличения, можно предположить, что это результат доразветки скважин. По итогам доразведки уточнялись параметры скважины и ее объём запасов. Исходя из этого, удалим первые (неуточненные данные), а последние записи (по индексу) в соответствующих "id" оставим для дальнейших расчетов.
6. Просмотр описательной статистики показал, что самый большой средний объём запасов в скважинах региона "data_2".
7. Стандартное отклонение в объёмах запасов в скважинах по трем регионам однородно и колеблется в пределах от 44 до 45 тыс. баррелей.
8. Максимальное значение объёма запасов в скважине, также зафиксировано в регионе "data_2" и составляет порядка 190 тыс. баррелей.
9. Аномально высоких или низких значений не обнаружено.
10. Дубликаты в данных не обнаружены.
11. Неявные дубликаты устранены.

## Обучение и проверка модели


```python
# функция вывода на печать предсказанного и истинного среднего запаса сырья, а также параметров, оценивающих качество модели
def param_model(data):
  # удаление столбцов из признаков
  # назначение целевого признака
  features = data.drop(['id', 'product'], axis=1)
  target = data['product']
  # деление данных на обучающую и валидационную выборки в соотношении 75:25
  features_train, features_valid, target_train, target_valid = train_test_split(
    features, target, test_size=0.25, random_state=12345)
  # обучение моли линейной регрессии на данных региона
  # вывод предсказанного среднего запаса сырья
  # вывод метрик качества модели линейной регрессии
  model = LinearRegression()
  model.fit(features_train, target_train)
  predicted_valid = model.predict(features_valid)
  mse = mean_squared_error(target_valid, predicted_valid)
  
  print("Предсказанный средний запас сырья =", round(predicted_valid.mean(), 1))
  print()
  print("RMSE =", round(mse ** 0.5, 1))
  print("MSE =", round(mse, 1))
  print("R2 =", round(r2_score(target_valid, predicted_valid), 1))
  print("MAE =", round(mean_absolute_error(target_valid, predicted_valid), 1))
  print()
  print("Истинное значение среднего запаса сырья =", round(data['product'].mean(), 1))
```

### Модель для региона "data_0"


```python
param_model(data_0)
```

    Предсказанный средний запас сырья = 92.6
    
    RMSE = 37.9
    MSE = 1438.4
    R2 = 0.3
    MAE = 31.2
    
    Истинное значение среднего запаса сырья = 92.5
    

### Вывод

**Анализ работы модели линейной регрессии для региона "data_0", показал:**

1. Предсказанный средний запас сырья = 92.6
2. Истинное значение среднего запаса сырья = 92.5
3. Модель демонстрирует хорошие результаты: предсказанное и истинное значения равны при округлении до целых (93=93)
4. RMSE = 37.9

### Модель для региона "data_1"


```python
param_model(data_1)
```

    Предсказанный средний запас сырья = 68.5
    
    RMSE = 0.9
    MSE = 0.8
    R2 = 1.0
    MAE = 0.7
    
    Истинное значение среднего запаса сырья = 68.8
    

### Вывод

**Анализ работы модели линейной регрессии для региона "data_1", показал:**

1. Предсказанный средний запас сырья = 68.5
2. Истинное значение среднего запаса сырья = 68.8
3. Модель демонстрирует хорошие результаты: предсказанное и истинное значения равны при округлении до целых (69=69)
4. RMSE = 0.9

### Модель для региона "data_2"


```python
param_model(data_2)
```

    Предсказанный средний запас сырья = 94.9
    
    RMSE = 40.2
    MSE = 1614.9
    R2 = 0.2
    MAE = 32.9
    
    Истинное значение среднего запаса сырья = 95.0
    

### Вывод

**Анализ работы модели линейной регрессии для региона "data_2", показал:**

1. Предсказанный средний запас сырья = 94.9
2. Истинное значение среднего запаса сырья = 95.0
3. Модель демонстрирует хорошие результаты: предсказанное и истинное значения равны при округлении до целых (95=95)
4. RMSE = 40.2

## Вывод

**А) Анализ работы модели линейной регрессии для региона "data_0", показал:**

1. Предсказанный средний запас сырья = 92.6
2. Истинное значение среднего запаса сырья = 92.5
3. Модель демонстрирует хорошие результаты: предсказанное и истинное значения равны при округлении до целых (93=93)
4. RMSE = 37.9

**Б) Анализ работы модели линейной регрессии для региона "data_1", показал:**

1. Предсказанный средний запас сырья = 68.5
2. Истинное значение среднего запаса сырья = 68.8
3. Модель демонстрирует хорошие результаты: предсказанное и истинное значения равны при округлении до целых (69=69)
4. RMSE = 0.9

**В) Анализ работы модели линейной регрессии для региона "data_2", показал:**

1. Предсказанный средний запас сырья = 94.9
2. Истинное значение среднего запаса сырья = 95.0
3. Модель демонстрирует хорошие результаты: предсказанное и истинное значения равны при округлении до целых (95=95)
4. RMSE = 40.2


## Подготовка к расчёту прибыли


```python
# дано по условию
EXPLORE_POINTS =500
BEST_POINTS = 200
BUDGET = 10 * 10 ** 9
INCOME_ONE_THOUSAND_BARREL = 450000
LOSS_PROBABILITY = 0.025
```


```python
# сколько можно потратить на одну скважину
budgeе_one_point = BUDGET / BEST_POINTS
budgeе_one_point
```




    50000000.0




```python
# сколько тысяч баррелей должно быть в скважине, чтобы вернуть потраченные деньги на ее разработку

minimum_barrels_point = budgeе_one_point / INCOME_ONE_THOUSAND_BARREL
minimum_barrels_point
```




    111.11111111111111



## Вывод

**В результате расчетов, установлено:**

1. Минимальное необходимое количество баррелей на одной разрабатываемой точке (для ее окупания) должно быть порядка 111 тыс. баррелей.
2. Среднее значение запасов баррелей по точкам в регионах меньше указанного значения (111 тыс. баррелей).
3. Так как, точек в регионах достаточно много (значительно больше 200), а также известно, что максимальные значения запасов в некоторых точках регионов "data_0", "data_1", "data_2" достигаю 185, 138, 190 тыс. баррелей соответственно, то целесообразно предположить, что проект вполне окупаем.

## Расчёт прибыли и рисков 


```python
# функция выбирает 200 лучших (на основе предсказания модели)
# возвращает пандовскую серию ИСТИННЫХ значений запасов баррелей 
def best_200_target(target_list_subsample):
  # удаление столбцов из признаков
  # назначение целевого признака
  features = target_list_subsample.drop(['id', 'product'], axis=1)
  target = target_list_subsample['product']
  # деление данных на обучающую и валидационную выборки в соотношении 75:25
  features_train, features_valid, target_train, target_valid = train_test_split(
    features, target, test_size=0.25, random_state=12345)
  # обучение моли линейной регрессии на данных региона
  # вывод предсказанного среднего запаса сырья
  # вывод метрик качества модели линейной регрессии
  model = LinearRegression()
  model.fit(features_train, target_train)
  predicted_valid = model.predict(features)
  
  predicted_valid = pd.Series(predicted_valid)
  best_200_predict = predicted_valid.sort_values(ascending=False).head(200)
  best_200_target = target[best_200_predict.index]

  return best_200_target
```


```python
# функция подсчета прибыли
def profit(list):
  profit = INCOME_ONE_THOUSAND_BARREL * list.sum() - BUDGET

  return profit
```


```python
# функция симплит 500 случайных скважин, выбирает среди низ 200 лучших (на основе предсказания модели)
# возвращает 95%-й доверительный интервал, среднюю прибыль, долю рисков на основе ИСТИННЫХ значений запасов баррелей
def sample(data):
  state = np.random.RandomState(12345)

  values = []
  values_risk = []
  for i in range(1000):
    target_list_subsample = data.sample(n=EXPLORE_POINTS, replace=True, random_state=state)
    target_list_subsample = target_list_subsample.reset_index(drop=True)
    #print(target_list_subsample)
    best_target = best_200_target(target_list_subsample)
    #print(best_target)
    prof = profit(best_target)
    if prof < 0:
      values_risk.append(prof)

    values.append(prof)
  values_risk = pd.Series(values_risk)
  values = pd.Series(values)
  
  lower = values.quantile(0.025)
  upper = values.quantile(0.975)
  percent_risk = len(values_risk) / len(values) * 100

  print("95%-й доверительный интервал: от", round(lower / 10**6), "до", round(upper / 10**6), "млн. руб.")
  print("Среднее значение прибыли:", round(mean(values) / 10**6), "млн. руб.")
  print("Доля рисков:", percent_risk, "%")
```

### Прибыль и риски для региона "data_0"


```python
sample(data_0)
```

    95%-й доверительный интервал: от -80 до 936 млн. руб.
    Среднее значение прибыли: 430 млн. руб.
    Доля рисков: 5.2 %
    

### Прибыль и риски для региона "data_1"


```python
sample(data_1)
```

    95%-й доверительный интервал: от 33 до 884 млн. руб.
    Среднее значение прибыли: 450 млн. руб.
    Доля рисков: 1.9 %
    

### Прибыль и риски для региона "data_2"


```python
sample(data_2)
```

    95%-й доверительный интервал: от -153 до 877 млн. руб.
    Среднее значение прибыли: 377 млн. руб.
    Доля рисков: 9.2 %
    

## Вывод

**Анализ прибыли и рисков регионов, показал:**

*A) В регионе "data_0":*

1. 95%-й доверительный интервал: от -80 до 936 млн. руб.
2. Среднее значение прибыли: 430 млн. руб.
3. Доля рисков: 5.2 %

*Б) В регионе "data_1":*

1. 95%-й доверительный интервал: от 33 до 884 млн. руб.
2. Среднее значение прибыли: 450 млн. руб.
3. Доля рисков: 1.9 %

*В) В регионе "data_2":*

1. 95%-й доверительный интервал: от -153 до 877 млн. руб.
2. Среднее значение прибыли: 377 млн. руб.
3. Доля рисков: 9.2 %


## Общий вывод

**В результате подготовки данных, установлено:**

1. Пропуски отсутствуют.
2. Тип данных во всех столбцах float64, кроме столбца "id" - object.
3. В регионе "data_0" - 10 пар с одинаковыми "id".
4. В регионах "data_1", "data_2" по 4 пары с одинаковыми "id".
5. Так как, прослеживается парность и параметры меняются либо в сторону уменьшения, либо в сторону увеличения, можно предположить, что это результат доразветки скважин. По итогам доразведки уточнялись параметры скважины и ее объём запасов. Исходя из этого, удалим первые (неуточненные данные), а последние записи (по индексу) в соответствующих "id" оставим для дальнейших расчетов.
6. Просмотр описательной статистики показал, что самый большой средний объём запасов в скважинах региона "data_2".
7. Стандартное отклонение в объёмах запасов в скважинах по трем регионам однородно и колеблется в пределах от 44 до 45 тыс. баррелей.
8. Максимальное значение объёма запасов в скважине, также зафиксировано в регионе "data_2" и составляет порядка 190 тыс. баррелей.
9. Аномально высоких или низких значений не обнаружено.
10. Дубликаты в данных не обнаружены.
11. Неявные дубликаты устранены.

**В результате обучения и проверки модели:**

*А) Анализ работы модели линейной регрессии для региона "data_0", показал:*

1. Предсказанный средний запас сырья = 92.6
2. Истинное значение среднего запаса сырья = 92.5
3. Модель демонстрирует хорошие результаты: предсказанное и истинное значения равны при округлении до целых (93=93)
4. RMSE = 37.9

*Б) Анализ работы модели линейной регрессии для региона "data_1", показал:*

1. Предсказанный средний запас сырья = 68.5
2. Истинное значение среднего запаса сырья = 68.8
3. Модель демонстрирует хорошие результаты: предсказанное и истинное значения равны при округлении до целых (69=69)
4. RMSE = 0.9

*В) Анализ работы модели линейной регрессии для региона "data_2", показал:*

1. Предсказанный средний запас сырья = 94.9
2. Истинное значение среднего запаса сырья = 95.0
3. Модель демонстрирует хорошие результаты: предсказанное и истинное значения равны при округлении до целых (95=95)
4. RMSE = 40.2

**В результате расчетов прибыли, установлено:**

1. Минимальное необходимое количество баррелей на одной разрабатываемой точке (для ее окупания) должно быть порядка 111 тыс. баррелей.
2. Среднее значение запасов баррелей по точкам в регионах меньше указанного значения (111 тыс. баррелей).
3. Так как, точек в регионах достаточно много (значительно больше 200), а также известно, что максимальные значения запасов в некоторых точках регионов "data_0", "data_1", "data_2" достигаю 185, 138, 190 тыс. баррелей соответственно, то целесообразно предположить, что проект вполне окупаем.

**Анализ прибыли и рисков регионов, показал:**

*A) В регионе "data_0":*

1. 95%-й доверительный интервал: от -80 до 936 млн. руб.
2. Среднее значение прибыли: 430 млн. руб.
3. Доля рисков: 5.2 %

*Б) В регионе "data_1":*

1. 95%-й доверительный интервал: от 33 до 884 млн. руб.
2. Среднее значение прибыли: 450 млн. руб.
3. Доля рисков: 1.9 %

*В) В регионе "data_2":*

1. 95%-й доверительный интервал: от -153 до 877 млн. руб.
2. Среднее значение прибыли: 377 млн. руб.
3. Доля рисков: 9.2 %

**РЕЗЮМЕ:**

*Наиболее перспективным для разработки скважин является регион "data_1", так как:*

1. Принесет потенциально большую среднюю прибыль: 450 млн. руб.
2. Имеет потенциально меньшее долю рисков: 1.9 %.
